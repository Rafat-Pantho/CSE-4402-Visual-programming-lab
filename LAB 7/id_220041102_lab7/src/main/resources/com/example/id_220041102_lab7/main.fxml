<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<StackPane fx:id="rootStack" xmlns="http://javafx.com/javafx/21"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="com.example.id_220041102_lab7.controller.MainController">

    <!-- Main content -->
    <BorderPane maxWidth="-Infinity" maxHeight="-Infinity">
        <top>
            <HBox spacing="10" BorderPane.alignment="CENTER">
                <padding><Insets top="16" right="16" bottom="12" left="16"/></padding>
                <Label text="Weather" styleClass="h2"/>
                <Region HBox.hgrow="ALWAYS"/>
                <TextField fx:id="cityField" promptText="Search city (e.g., Dhaka, London, Tokyo)" prefWidth="360"/>
                <Button fx:id="searchBtn" text="Search" onAction="#onSearchClicked"/>
                <ToggleButton fx:id="themeToggle" text="Dark Mode"/>
            </HBox>
        </top>

        <center>
            <ScrollPane fitToWidth="true" hbarPolicy="NEVER" styleClass="center_bg">
                <content>
                    <VBox spacing="18" fillWidth="true" styleClass="center_bg">
                        <padding><Insets top="10" right="16" bottom="24" left="16"/></padding>

                        <!-- Error -->
                        <Label fx:id="errorLabel" textFill="#d9534f" visible="false" managed="false" wrapText="true"/>

                        <!-- Current weather card -->
                        <VBox spacing="10" styleClass="card">
                            <HBox spacing="16" alignment="CENTER_LEFT">
                                <ImageView fx:id="currentIcon" fitWidth="72" fitHeight="72" preserveRatio="true"/>
                                <VBox spacing="6">
                                    <Label fx:id="cityNameLabel" styleClass="h3" text="City, Region (Country)"/>
                                    <Label fx:id="localTimeLabel" text="Local time: "/>
                                </VBox>
                            </HBox>
                            <GridPane hgap="16" vgap="8">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                </columnConstraints>
                                <rowConstraints>
                                    <RowConstraints vgrow="NEVER"/>
                                    <RowConstraints vgrow="NEVER"/>
                                </rowConstraints>

                                <Label text="Temperature:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                                <Label fx:id="tempLabel" text="--" GridPane.rowIndex="0" GridPane.columnIndex="1"/>

                                <Label text="Feels like:" GridPane.rowIndex="0" GridPane.columnIndex="2"/>
                                <Label fx:id="feelsLabel" text="--" GridPane.rowIndex="0" GridPane.columnIndex="3"/>

                                <Label text="Humidity:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                                <Label fx:id="humidityLabel" text="--" GridPane.rowIndex="1" GridPane.columnIndex="1"/>

                                <Label text="Clouds:" GridPane.rowIndex="1" GridPane.columnIndex="2"/>
                                <Label fx:id="cloudsLabel" text="--" GridPane.rowIndex="1" GridPane.columnIndex="3"/>

                                <Label text="Precipitation:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                                <Label fx:id="precipLabel" text="--" GridPane.rowIndex="2" GridPane.columnIndex="1"/>

                                <Label text="Air Quality (US EPA):" GridPane.rowIndex="2" GridPane.columnIndex="2"/>
                                <Label fx:id="aqiLabel" text="--" GridPane.rowIndex="2" GridPane.columnIndex="3"/>
                            </GridPane>
                        </VBox>

                        <!-- 3-day forecast -->
                        <VBox spacing="8">
                            <Label text="3-Day Forecast" styleClass="h3"/>
                            <HBox fx:id="forecastBox" spacing="12"/>
                        </VBox>

                        <!-- 7-day history -->
                        <VBox spacing="8" styleClass="center_bg">
                            <Label text="Past 7 Days" styleClass="h3"/>
                            <TableView fx:id="historyTable" prefHeight="320">
                                <columns >
                                    <TableColumn fx:id="colDate" text="Date" prefWidth="120" styleClass="card" />
                                    <TableColumn fx:id="colCond" text="Condition" prefWidth="220" styleClass="card"/>
                                    <TableColumn fx:id="colMin" text="Min" prefWidth="100" styleClass="card"/>
                                    <TableColumn fx:id="colMax" text="Max" prefWidth="100" styleClass="card"/>
                                    <TableColumn fx:id="colHum" text="Avg Humidity" prefWidth="140" styleClass="card"/>
                                    <TableColumn fx:id="colPrecip" text="Total Precip" prefWidth="120" styleClass="card"/>
                                </columns>
                            </TableView>
                        </VBox>

                    </VBox>
                </content>
            </ScrollPane>
        </center>
    </BorderPane>

    <!-- Loading overlay -->
    <ProgressIndicator fx:id="loadingSpinner" maxWidth="90" maxHeight="90" visible="false" managed="false"/>

</StackPane>
